               ;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^;
               ;    Author    : Chanartip Soonthornwan                     ;
               ;    Student_ID: 014353883                                  ;
               ;    Email     : Chanartip.Soonthornwan@gmail.com           ;
               ;    Subject   : CECS490                                    ;
               ;    Assignment: Testing I2C Master                         ;
               ;                                                           ;
               ;    Current Version: 1.0                                   ;
               ;    Date      : October 11, 2018                           ;
               ;                                                           ;
               ;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^;
               I2C_ADDR_PORT	EQU		0001
               I2C_DATA_PORT	EQU		0002
               I2C_CMD_PORT	EQU		0003
               I2C_STATUS_PORT EQU		0004
               SW_ADDR_PORT	EQU		0005
               SW_DATA_PORT	EQU 	0006
               
               ADDR_REG		EQU		R1
               DATA_REG		EQU		R2
               CMD_REG			EQU		R3
               READY_REG		EQU		R4
               FIRE_REG		EQU		R5
               DATA_			EQU		R6	
               
               A_	EQU 0061
               B_	EQU 0062
               C_	EQU 0063
               D_	EQU 0064
               E_	EQU 0065
               F_	EQU 0066
               G_	EQU 0067
               H_	EQU 0068
               I_	EQU 0069
               J_	EQU 006a
               K_	EQU 006b
               L_	EQU 006c
               M_	EQU 006d
               N_	EQU 006e
               O_	EQU 006f
               P_	EQU 0070
               Q_	EQU 0071
               R_	EQU 0072
               S_	EQU 0073
               T_	EQU 0074
               U_	EQU 0075
               V_	EQU 0076
               W_	EQU 0077
               X_	EQU 0078
               Y_	EQU 0079
               Z_	EQU 007a
               
                           ADDRESS 0000
               INIT
               			LOAD	ADDR_REG, 000F
0000 AE01 000F
               			LOAD 	DATA_REG, A_
0002 AE02 0061
               			LOAD	CMD_REG,  0001
0004 AE03 0001
               			LOAD	DATA_, A_
0006 AE06 0061
               			
               START       ENINT
0008 1E00               
               ; Main Loop
               MAIN
               			JUMP	MAIN
0009 A400 0009
               			
               
               ;=============================================================
               ;   ISR vectored through 0FFE
               ;   Jump to ISR routine
               ;=============================================================	
               			ADDRESS 0E00
               ISR
               			INPUT	READY_REG, I2C_STATUS_PORT
0E00 A204 0004
               			COMP	READY_REG, 0001
0E02 9804 0001
               			JUMPZ	I2C_READY_TO_START
0E04 AA00 0e07
               			
               			RETEN
0E06 4600               			
               I2C_READY_TO_START		
               				
               			OUTPUT	ADDR_REG, I2C_ADDR_PORT
0E07 B801 0001
               			OUTPUT  DATA_, I2C_DATA_PORT
0E09 B806 0002
               			OUTPUT 	CMD_REG,  I2C_CMD_PORT
0E0B B803 0003
               			
               DELAY
                           LOAD    R8, FFFF
0E0D AE08 FFFF
                           LOAD    R9, 0019
0E0F AE09 0019
               TAG
                           SUB     R8, 0001
0E11 DC08 0001
                           JUMPNZ  TAG
0E13 AC00 0e11
                           LOAD    R8, FFFF
0E15 AE08 FFFF
                           SUB     R9, 0001
0E17 DC09 0001
                           JUMPNZ  TAG
0E19 AC00 0e11
               
               			
               			COMP	DATA_, Z_
0E1B 9806 007A
               			JUMPNZ	ADD_ONE
0E1D AC00 0e22
               			
               			LOAD	DATA_, A_
0E1F AE06 0061
               			RETEN
0E21 4600               			
               ADD_ONE
               			ADD		DATA_, 0001
0E22 8206 0001
               		
               			RETEN
0E24 4600               
               
               			ADDRESS 0FFE
               			
               ENDIT
                           JUMP ISR
0FFE A400 0e00
               
                           END
